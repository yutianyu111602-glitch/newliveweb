# AI 团队讨论会议记录 - 2026-02-02

## 会议主题
newliveweb 下一步最值得做的三件事（第二轮讨论 - 优化双层 ProjectM 3D 时空耦合算法）

## 参与专家
- **DeepSeek**（算法架构/数学原理）
- **Qwen**（数据流水线/性能优化）
- **GLM**（产品应用/用户价值）
- **Kimi**（测试保障/质量控制）

## 背景数据资源
- **AIVJ_FINAL_ELITE**: 500+ 精英 AIVJ 预设对（含 score/rank）
- **aivj_coupled_refinery_v2**: 104,040 对成对预设精炼数据（已由另一 AI 完成）
- **deep_alchemy_10h**: 2,001 对深度学习预设（quality=0.8）
- **coupling_net_best.pth**: 4.6MB 预训练耦合网络模型

---

## 第二轮讨论：优化双层 ProjectM 3D 时空耦合算法

### DeepSeek 专家建议（算法架构）

#### 1. 基于精英数据的自适应时空权重学习
- **技术方案**：利用 500+ 精英对训练轻量级权重预测网络，动态调整空间权重 \(w_s\) 和时间权重 \(w_t\)
- **数学原理**：
  - 损失函数：\(L = \sum_{i=1}^{N} \left( \text{rank}_i - \sigma(w_s \cdot S_i + w_t \cdot T_i + b) \right)^2\)
  - 通过反向传播学习最优权重
- **数据利用**：直接使用 `AIVJ_FINAL_ELITE/` 中的 500+ 精英对

#### 2. 双层耦合的残差注意力机制
- **技术方案**：引入残差注意力模块增强上下层特征交互
- **数学原理**：
  - \( \text{Attn}(Q, K, V) = \text{Softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right) V + \text{Residual}(Q) \)
  - 动态融合时空特征，残差连接保证梯度流动
- **数据利用**：使用 104,040 对精炼数据进行端到端训练

#### 3. 基于分数分布的耦合损失重加权
- **技术方案**：根据 score 分布设计重加权损失函数，聚焦高区分度样本
- **数学原理**：
  - 样本权重：\( \alpha_i = \frac{\exp(\beta \cdot \text{score}_i)}{\sum_j \exp(\beta \cdot \text{score}_j)} \)
  - 耦合损失：\( L_{\text{coupled}} = \sum_{i=1}^{N} \alpha_i \cdot \| \mathbf{F}_{\text{upper}}^{(i)} - \mathbf{F}_{\text{lower}}^{(i)} \|_2^2 \)
- **数据利用**：利用精炼数据中的 score 字段计算权重分布

---

### Qwen 专家建议（数据流水线）

#### 1. 分层缓存 + Parquet 列式加速
- 将 `aivj_coupled_refinery_v2/` 全量数据转换为分区 Parquet（按 `score_bin`, `rank_quartile` 分区）
- 启用 Snappy 压缩与 dictionary encoding
- 精英数据单独存为内存映射 Parquet（`mmap=True`）
- **效果**：I/O 吞吐提升 3–5×

#### 2. 增量流式重加权 pipeline
- 基于 `refinery_v2_*.log` 中的 score/rank 变更事件
- 用 Apache Flink 构建轻量流处理器（state backend = RocksDB）
- 动态重计算时空耦合权重（Δ-weight = f(Δscore, Δrank, temporal_decay)）
- 输出至 Redis Sorted Set，ProjectM 直接 `ZREVRANGEBYSCORE` 获取 top-k

#### 3. 精英数据优先调度器（EDPS）
- 在 DataLoader 层注入自定义 Sampler
- 每 batch 固定混合 4 个精英样本 + 32 个常规样本
- 使用 PyTorch `WeightedRandomSampler` + `persistent_workers=True`
- **效果**：消除 I/O 瓶颈，强制模型高频接触高信噪比信号

---

### GLM 专家建议（产品应用）

#### 1. 智能音乐风格适配引擎
- **产品价值**：用户上传音乐后自动识别风格并推荐最优 3D 视觉效果
- **技术方案**：
  - 用 104,040 对精炼数据训练音乐特征→视觉参数映射模型（CNN+LSTM）
  - 500+ 精英数据作为风格基准，覆盖 EDM、古典、电子等流派
  - 实时推理延迟 <100ms，支持 WebAssembly 部署

#### 2. 渐进式效果学习系统
- **产品价值**：根据用户点击/停留时间持续优化推荐效果，提升长期留存
- **技术方案**：
  - 用户反馈闭环：记录评分/使用时长，存入用户偏好向量
  - 联邦学习：本地更新模型，定期同步到服务器（保护隐私）
  - A/B 测试框架验证优化效果

#### 3. 精英效果模板市场
- **产品价值**：一键应用高质量预设，支持分享和变现
- **技术方案**：
  - 500+ 精英数据打包为模板库，含完整 ProjectM 参数 + score/rank 标签
  - 精炼数据用于效果相似度计算（欧氏距离）
  - 社区机制：用户上传自定义效果，系统自动评分并对比排序
  - 分层推荐：免费层（Top 50 精英）+ 高级层（全库 + 自定义）

---

### Kimi 专家建议（测试保障）

#### 1. 分层回归测试体系（数据分层验证）
- 将 104,040 对数据按 score 分桶（A/B/C/D 四级），每级随机采样 2% 作为回归测试集
- 500+ 精英数据作为**黄金标准集（Golden Set）**，任何算法变更必须 100% 通过
- CI 流水线：每次提交 → 快速验证（2,080 对）→ 全量回归（Golden Set）

#### 2. 双向一致性校验（算法验证）
- 新旧算法**双轨运行**：同一输入分别跑旧版（baseline）和新版（optimized）
- 定义容差阈值：3D 坐标误差 < 0.5%，时序相位差 < 1 帧，视觉评分偏差 < 5%
- 对 500 精英数据做**像素级比对**（SSIM/PSNR），输出差异热力图

#### 3. 监控看板 + 自动回滚
- 部署 Grafana 看板，实时展示：
  - 精英数据通过率
  - 全量数据 score 分布漂移（KL 散度）
  - 算法耗时 P99/P95
- 设置硬门槛：精英通过率 < 98% 或分布漂移 > 0.1 自动触发回滚
- 每次发布前输出**质量报告**：通过率、性能提升、视觉对比截图

---

## 第三轮讨论主题（待进行）
- **全自动训练流水线设计**
- **长时间智能自训练程序长跑方案**

## 相关文档
- 优化计划：`docs/ai_team_meeting_records/AI_TEAM_PLAN_OPTIMIZATION.md`
- 原始数据：`D:\aidata\AIVJ_FINAL_ELITE\`
- 精炼数据：`D:\aidata\aivj_coupled_refinery_v2\`
- 预训练模型：`D:\aidata\deep_alchemy_10h\coupling_net_best.pth`

---

*会议记录创建时间：2026-02-02 11:20 GMT+8*
